#!/usr/bin/perl

use strict;
use warnings;

print <<INTRO;
// Autogenerated file.  DO NOT EDIT!
// Edit sw_list.h or perl/sw_sort.pl instead.

switchinfo switches[] = {

INTRO

my $repl;
my %sw;
while (<>) {
	s#//.*##;
	next if /^\s*$/;
	last if /^\s*SWITCHORDER:/;
	if (/##(.*?)##/) {
		$repl = $1;
		next;
	}
	s/'(.)'/
		my $a=$repl; my $b=$1;
		$a =~ s#\bch\b#'$b'#g;
		$a
	/e if $repl;

	/"(.*?)"/ or /'(.)'/ or next;
	die "Duplicate cfg name $1" if exists $sw{$1};
	$sw{$1} = $_;
}
print $sw{$_} for sort keys %sw;

print <<FOOTER;
	SPCL (  0, NULL, 0, NULL)
};

u8 switchorder[] = {
FOOTER

print while (<>);

print <<FOOTER2;
};
FOOTER2
