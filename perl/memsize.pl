#!/usr/bin/perl -l

use strict;
use warnings;

# generates memsize.h from the output of mem /c run by TTDPatch

print "// Autogenerated file.  DO NOT EDIT!";
print "// Edit perl/memsize.pl instead.";
print "";

my $found = 0;
while(<>) {
	next unless /TTDPATCH/;
	$found++;
	tr/\n\r//d;
	print "// Output from mem /c:";
	print "// $_\n";
	my $size = (split " ", $_)[1];
	$size =~ tr/,.//d;
	print "#define TTDPATCHSIZE $size";
}

exit($found != 1);
